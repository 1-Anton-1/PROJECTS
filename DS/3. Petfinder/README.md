# 3. Petfinder 

## Цель:

Создать модель, предсказывающую на основе данных о животном, то как быстро это животное заберут из приюта. 

## Описание:

Миллионы бездомных животных ежедневно страдают на улицах или подвергаются эвтаназии в приютах по всему миру. Если для них будет найден дом, можно будет спасти много драгоценных жизней и создать больше счастливых семей. Платформа PetFinder.my разрабатывает инструмент на основе ИИ, который оценивает насколько милыми являются питомцы на основании метаданных о них. В этой задаче необходимо разработать алгоритм прогнозирования возможности усыновления домашних животных (как быстро будет усыновлено то или иное животное).  

### Исходные данные [источник](https://www.kaggle.com/competitions/petfinder-adoption-prediction):
	
`train.csv` - тренировочный датафрейм, содержащий данные о питомцах

`test.csv` - тестовый датафрейм, содержащий те же колонки, что и `train`, но без колонки "AdoptionSpeed" как быстро животное забрали из приюта после размещения информации о нем на платформе.

Описание колонок датафреймов `train` и `test`:

		 

### В чем состоит решение задачи?
 


#### Краткое описание имплементации задачи:

1. Импортируем библиотеки и считываем данные из input-датафрейма (`train.csv`).
2. Изучим имеющиеся данные, приведем к корректному типу некоторые значения колонок. Выделим главные фичи, с которыми коррелирует наша целевая переменная (здоровье, возраст, внешний вид, привито/не привито)
3. Удаляем лишние фичи, которые не оказывают сколь-нибудь значимого влияния на целевой показатель.
4. Делим тренировочные данные на тренировочный и тестовые датасеты.
5. Создадим функцию-pipeline для прогонки все наших будущих решений.
6. Инициализируем классификатор по методу ближайших соседей (k-NN классификатор) и посмотрим на точность модели при k<10 - score около 0,26. Так как в наших данных много категориальных переменных, то такое решение не эффективно.
7. Посмотрим на точность предсказания, применив модель RandomForestClassifier. Точность при n_estimators=25, n_jobs=4 получилась чуть выше предыдущей (score около 0,27).
8. В двух предыдущих подходах, мы не учитывали влияние такой важной для колонки "AdoptionSpeed" фичи как фото животного! И самым главным безусловно является первое фото животного, то которое в первую очередь видят пользователи.
9. Проверяем наличие фото у животных и приводим их все к одному виду .convert('RGB').
10. Создаем матрицу эмбеддингов переведя картинки в векторный вид. Присоединяем матрицу векторов к нашему исходному датафрейму.
11. Применив метод RandomForest на 1019 фичах, получаем низкие результаты. Слишком много фичей. Применим метод главных компонент.
12. 


## Итоги
Точность предсказания нейросети обученной методом градиентного спуска оказалась равной 96,45%, что меньше точности, которую дают сверточные нейросети CNN. Однако, такой подход к решению задачи позволил детально разобраться в процессе формирования и обучения нейросети методом градиентного спуска.  
