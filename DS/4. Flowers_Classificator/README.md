# 4. Flowers_Classificator

## Цель:

Создать модель-классификатор, определяющий по фото цветка к какому виду относится растение. 

## Описание:

В решении этой задачи создаем и обучаем нейронную сеть для классификации изображений цветов. Результаты оцениваем на новом изображении, которое раньше не видела модель.  

### Исходные данные:
	
Для тренировки модели-классификатора загружаем [датасет](https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz) фотографий цветов. 


### В чем состоит решение задачи?

Загружаем и предобрабатываем набор данных. Разделяем набор данных на тренировочный и тестовый. Затем создаем нейронную сеть с использованием библиотеки TensorFlow и Keras и обучаем её на тренировочных данных. Для решения проблемы переобучения применяем методы аугментации данных и регуляризации. Проверяем точность предсказания нейросети на случайном фото цветка.

### Краткое описание имплементации задачи:

1. Импортируем необходимые библиотеки.
2. Загружаем набор данных с изображениями цветов по заданному URL-адресу и сохраняем в локальной директории.
3. Создаем объект dataset_dir, который представляет путь к директории с распакованными данными. Определяем общий набор данных в директории.
4. Задаем размер пакета (batch_size) - количество изображений, обрабатываемых одновременно моделью при обучении.
5. Создаём два набора данных: тренировочный (train_ds) и тестовый (val_ds) с использованием функции tf.keras.utils.image_dataset_from_directory. Набор данных разделяется на тренировочный и тестовый в соотношении 80/20 с помощью параметра validation_split.
6. Получаем имена классов, которые представлены в данных, с помощью train_ds.class_names. Эти имена будем использовать для интерпретации результатов.
7. Кешируем и предварительно загружаем данные для увеличения производительности с помощью cache и prefetch.
8. Создаём модель нейронной сети.
9. Компилируем модель с использованием оптимизатора Adam, функции потерь SparseCategoricalCrossentropy и метрики accuracy. 
10. Обучаем модель на тренировочных данных в течение 10 эпох с использованием model.fit(). Историю обучения сохраняеем в переменной history.
11. Визуализируем точность и потери модели на тренировочных и тестовых данных с использованием графиков, созданных с помощью matplotlib. Смотря на графики видим, что модель переобучена на тестовых данных.
12. Для ршения проблемы переобучения в параметры модели добавляем аугментацию и регуляризацию.
13. Обучаем модель снова на трениоровчных данных, но уже в течении 20 эпох. Результы обучения снова выводим на экран в виде графиков.
14. Загружаем случайное изображение цветка из Интернета, и переводим в нужный формат для использования моделью.
15. Делаем предсказание для загруженного изображения и выводим класс с наибольшей вероятностью.

## Итоги:

Получилась несложная в реализации модель-классификатор и в тоже время с хорошими показателями точности классификации.
